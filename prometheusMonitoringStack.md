# Prometheus monitoring stack components

Open source helm chart:
- https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack
- https://github.com/prometheus-operator/prometheus-operator

The **Prometheus Monitoring Stack** refers to a set of tools and components that work together with Prometheus to provide a comprehensive monitoring and alerting solution. These tools complement Prometheus by offering features like visualization, long-term storage, log aggregation, and more.

### Key Components of the Prometheus Monitoring Stack:

#### 1. **Prometheus**
   - **Role**: Time-series database and monitoring system.
   - **Functionality**: Scrapes metrics from targets, stores them in a time-series format, and provides a query language called PromQL for analysis and alerting.
   - **Core Use**: Collecting and processing metrics.

---

#### 2. **Alertmanager**
   - **Role**: Handles alerts generated by Prometheus.
   - **Functionality**:
     - Deduplicates, groups, and routes alerts to different receivers like email, Slack, PagerDuty, or other notification tools.
     - Supports silencing and inhibition to avoid alert noise.
   - **Core Use**: Manages and delivers alerts effectively.

---

#### 3. **Visualization Tools**
These tools help visualize Prometheus metrics in a user-friendly way.

   - **a. Grafana**
     - **Role**: Visualization and dashboard tool.
     - **Functionality**:
       - Connects to Prometheus (and other data sources) to create interactive, customizable dashboards.
       - Supports sharing dashboards and setting alerts directly on visualizations.
     - **Core Use**: Displaying metrics and trends graphically.

  - **b. Prometheus UI**
    - Built-in basic visualization tool for querying and displaying metrics using PromQL (less powerful than Grafana).

---

#### 4. **Exporters**
   - **Role**: Expose metrics from various systems and services in a format Prometheus can scrape.
   - **Examples**:
     - **Node Exporter**: Collects hardware and OS-level metrics (CPU, memory, disk, etc.).
     - **cAdvisor**: Exports metrics for Docker containers.
     - **Blackbox Exporter**: Performs black-box monitoring (e.g., HTTP, DNS, and TCP probes).
     - **Database Exporters**: For systems like MySQL, PostgreSQL, or Redis.
   - **Core Use**: Gather metrics from specific sources.

---

#### 5. **Pushgateway**
   - **Role**: Allows short-lived jobs (e.g., batch jobs) to push metrics to Prometheus.
   - **Functionality**: Acts as an intermediary for pushing metrics to Prometheus.
   - **Core Use**: Monitoring ephemeral or on-demand jobs that don't exist long enough for Prometheus to scrape directly.

---

#### 6. **Service Discovery**
   - **Role**: Automatically discovers and updates the list of scrape targets.
   - **Examples**:
     - Kubernetes
     - AWS EC2
     - Consul
     - Docker Swarm
   - **Core Use**: Ensures Prometheus can dynamically adapt to changing environments without manual configuration.

---

#### 7. **Long-Term Storage (Optional)**
   Prometheus is optimized for real-time monitoring and short-term data retention. For long-term storage, you can integrate Prometheus with tools like:
   - **Thanos**: Adds long-term storage, high availability, and global querying to Prometheus.
   - **Cortex**: Provides scalable, multi-tenant Prometheus storage.
   - **VictoriaMetrics**: A high-performance, cost-effective alternative for storing Prometheus metrics.

---

#### 8. **Log Aggregation (Optional)**
   - Prometheus itself does not handle logs. To correlate metrics and logs, integrate it with tools like:
     - **Loki**: A log aggregation tool by Grafana Labs designed to work well with Prometheus.
     - **ELK Stack (Elasticsearch, Logstash, Kibana)**: A popular alternative for log aggregation and visualization.

---

### Typical Architecture of the Prometheus Monitoring Stack:
1. **Data Collection**:
   - Exporters and instrumented applications expose metrics.
   - Prometheus scrapes these metrics at regular intervals.

2. **Data Storage**:
   - Metrics are stored locally in Prometheus or in a long-term storage system (e.g., Thanos or Cortex).

3. **Visualization**:
   - Grafana connects to Prometheus to create dashboards for visualizing metrics.

4. **Alerting**:
   - Prometheus sends alerts to Alertmanager, which routes them to notification channels.

---

### Benefits of the Prometheus Monitoring Stack:
- **Open Source**: Free and community-supported.
- **Scalable**: Can monitor large, distributed systems.
- **Modular**: Components can be used independently or combined based on your needs.
- **Extensible**: Integrates with various tools, exporters, and ecosystems.

This stack has become a go-to solution for modern cloud-native monitoring, particularly in environments like **Kubernetes**, where dynamic service discovery and containerized workloads are common.
